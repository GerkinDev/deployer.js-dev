/**
 * @file Generates the documentation of javascript
 * @description Generates the documentation of javascript
 *
 * @author Gerkin
 * @copyright 2016 GerkinDevelopment
 * @license http://www.gnu.org/licenses/gpl-3.0.en.html GPL v3
 * @package deployer.js
 *
 * @version 0.2.2
 */
const randomstring=require("randomstring");module.exports={process:function(e,o){console.log("In JSDoc",e);var t=filesFromSelectors(e.selection);console.log(t);var n=t.length;if(0==n)return deployer.log.info("JSDOC => No files to document with jsdoc"),o();for(var s=0;n>s;s++)t[s]=path.resolve(".",t[s]);var i={base:"path"};e.typepath&&(i.type=e.typepath);var r={tags:{allowUnknownTags:!0,dictionnaries:["jsdoc","closure"]},source:{include:t},plugins:e.plugins?e.plugins:[],templates:{cleverLinks:!1,monospaceLinks:!1},opts:{template:"templates/default",encoding:"utf8",destination:e.destinationPath,recurse:!0}};console.log("DestinationPath ",e.destinationPath),e.template&&(r.opts.template="templates/"+e.template),e.tutorials&&(r.opts.tutorials=path.resolve(".",e.tutorials));var l="jsdoc-"+randomstring.generate(15)+"-config.json",a=path.resolve("/tmp",l);fs.writeFile(a,JSON.stringify(r,null,4),function(t){var n=[];e["private"]&&n.push("-p"),n.push("--verbose"),n.push("-c"),n.push(a),deployer.log.info('JSDOC => Command: "'+n+'"');var s=child_process.spawn("jsdoc",n);s.stdout.on("data",function(e){deployer.log.verbose("JSDOC =>",e.toString("UTF-8").slice(0,-1))}),s.stderr.on("data",function(e){deployer.log.error("JSDOC =>",e.toString("UTF-8").slice(0,-1))}),s.on("exit",function(e){deployer.log.info("JSDOC => Process JSDOC exited with code "+e),deployer.config.dirty?o():fs.unlink(a,function(e){e&&deployer.warn("JSDOC => Could not unlink config file "+a),o()})})})}};