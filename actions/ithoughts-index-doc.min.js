/**
 * @file actions/ithoughts-index-doc generates the documentation index
 *
 * @author Gerkin
 * @copyright 2016 GerkinDevelopment
 * @license http://www.gnu.org/licenses/gpl-3.0.en.html GPLv3
 * @package deployer.js
 *
 */
const swig=require("swig"),ncp=require("ncp");module.exports={process:function(e,r){var o=path.resolve(deployer.config.base_path,"templates/"+e.template+"/"+e.template+".html.swig"),l={title:e.project_name,author:e.author,now:new Date,head_links:e.head_links,index_url:e.root,version_url:e.baseUrl,resources:e.resourcesUrl};deployer.log.silly("ITHOUGHTS-INDEX-DOC => config:",JSON.stringify(l,null,4));var t=e.basePath,i=swig.renderFile(o,l);mkdir(t),mkdir(deployer.config.project.documentation.resources.path),ncp.ncp(path.resolve(deployer.config.base_path,"templates/"+e.template+"/resources"),deployer.config.project.documentation.resources.path,function(e){deployer.log.silly("ITHOUGHTS-INDEX-DOC => Resource files copied"),e&&deployer.log.error(e),fs.writeFile(path.resolve(t,"index.html"),i,function(e){e?deployer.log.error("ITHOUGHTS-INDEX-DOC => Error while writing index of doc:",e):deployer.log.silly("ITHOUGHTS-INDEX-DOC => Index of doc written"),r()})})}};